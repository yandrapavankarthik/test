<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>My E-Commerce</title>
  <style>
    body { font-family: sans-serif; margin: 20px; }
    .controls { margin-bottom: 20px; }
    .product { display: inline-block; width: 200px; margin: 10px; border: 1px solid #ccc; padding: 10px; cursor: pointer; }
    .product img { width: 100%; }
    .modal {
      display: none; position: fixed; top: 0; left: 0;
      width: 100%; height: 100%; background: rgba(0, 0, 0, 0.6);
      justify-content: center; align-items: center;
    }
    .modal-content {
      background: white; padding: 20px; max-width: 500px; width: 90%; border-radius: 5px;
    }
    .modal img { width: 100%; }
    .close { float: right; cursor: pointer; font-size: 20px; }
    .buy-btn {
      background: #28a745; color: white; padding: 10px 20px;
      text-decoration: none; display: inline-block; margin-top: 10px;
      border-radius: 4px;
    }
  </style>
</head>
<body>

<h1>My Products</h1>

<div class="controls">
  <label for="categoryFilter">Category:</label>
  <select id="categoryFilter">
    <option value="All">All</option>
    <option value="Shirt">Shirt</option>
    <option value="T-Shirt">T-Shirt</option>
  </select>

  <label for="sortOrder">Sort by Price:</label>
  <select id="sortOrder">
    <option value="default">Default</option>
    <option value="low">Low to High</option>
    <option value="high">High to Low</option>
  </select>
</div>

<div id="products"></div>

<!-- Modal -->
<div id="modal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="document.getElementById('modal').style.display='none'">&times;</span>
    <img id="modal-img">
    <h2 id="modal-title"></h2>
    <p id="modal-description"></p>
    <p><strong>Price:</strong> <span id="modal-price"></span></p>
    <p><strong>Size:</strong> <span id="modal-size"></span></p>
    <a id="modal-buy" class="buy-btn" target="_blank">Buy Now</a>
  </div>
</div>

<script>
  let allProducts = [];

  fetch('products.json')
    .then(res => res.json())
    .then(products => {
      allProducts = products;
      renderProducts(products);
    });

  function renderProducts(products) {
    const container = document.getElementById('products');
    container.innerHTML = '';
    products.forEach(product => {
      const div = document.createElement('div');
      div.className = 'product';
      div.innerHTML = `<img src="${product.image}" alt="${product.name}"><h3>${product.name}</h3><p>$${product.price}</p>`;
      div.onclick = () => showModal(product);
      container.appendChild(div);
    });
  }

  function showModal(product) {
    document.getElementById('modal-img').src = product.image;
    document.getElementById('modal-title').textContent = product.name;
    document.getElementById('modal-description').textContent = product.description;
    document.getElementById('modal-price').textContent = `$${product.price}`;
    document.getElementById('modal-size').textContent = product.size;
    document.getElementById('modal-buy').href = product.buyLink;
    document.getElementById('modal').style.display = 'flex';
  }

  document.getElementById('categoryFilter').addEventListener('change', updateDisplay);
  document.getElementById('sortOrder').addEventListener('change', updateDisplay);

  function updateDisplay() {
    let filtered = [...allProducts];
    const category = document.getElementById('categoryFilter').value;
    const sortOrder = document.getElementById('sortOrder').value;

    if (category !== 'All') {
      filtered = filtered.filter(p => p.category === category);
    }

    if (sortOrder === 'low') {
      filtered.sort((a, b) => a.price - b.price);
    } else if (sortOrder === 'high') {
      filtered.sort((a, b) => b.price - a.price);
    }

    renderProducts(filtered);
  }

  window.onclick = e => {
    if (e.target.id === 'modal') {
      document.getElementById('modal').style.display = 'none';
    }
  };
</script>

</body>
</html>
